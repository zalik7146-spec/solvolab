<!doctype html>
<html lang="ru">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover"/>
  <title>SolvoLab</title>
  <meta name="description" content="SolvoLab ‚Äî Workspace –∏ Mind Space —Å –æ—Ç–¥–µ–ª—å–Ω—ã–º–∏ —Å—Ç—Ä–∞–Ω–∏—Ü–∞–º–∏ –∏ –∫–∞–ª–µ–Ω–¥–∞—Ä—ë–º.">
  <!-- –§–æ–Ω—Ç—ã -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;800&display=swap" rel="stylesheet">
  <!-- React UMD -->
  <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
  <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
  <style>
    :root{
      --bg:#0a0f15; --fg:#e9edf3; --muted:#aab3bf;
      --card: rgba(255,255,255,.05); --border: rgba(255,255,255,.08);
      --acc1:#7dd3fc; --acc2:#a78bfa; --acc3:#34d399; --acc4:#f472b6;
      --danger:#ef4444; --warn:#f59e0b; --ok:#10b981;
      --shadow: 0 10px 40px rgba(0,0,0,.35);
    }
    * { box-sizing: border-box; }
    html, body, #root { height: 100%; }
    body {
      margin: 0;
      background:
        radial-gradient(1200px 600px at 20% -10%, rgba(125,211,252,.12), transparent 60%),
        radial-gradient(1000px 600px at 120% 0%, rgba(167,139,250,.12), transparent 60%),
        var(--bg);
      color: var(--fg);
      font-family: Inter, -apple-system, system-ui, "SF Pro Display", "Segoe UI", Roboto, Arial, sans-serif;
      -webkit-font-smoothing: antialiased;
      -moz-osx-font-smoothing: grayscale;
      -webkit-text-size-adjust: 100%;
      -webkit-tap-highlight-color: transparent;
      overscroll-behavior: none;
    }
    a { color: inherit; text-decoration: none; }
    button { font: inherit; }

    /* –≠–∫—Ä–∞–Ω –±–µ–∑ –≤–µ—Ä—Ç–∏–∫–∞–ª—å–Ω–æ–≥–æ —Å–∫—Ä–æ–ª–ª–∞ (–≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏–µ –æ–±–ª–∞—Å—Ç–∏ —Å–∞–º–∏ —É–ø—Ä–∞–≤–ª—è—é—Ç —Å–æ–¥–µ—Ä–∂–∏–º—ã–º) */
    .screen {
      height: 100svh; /* iOS Safari –∫–æ—Ä—Ä–µ–∫—Ç–Ω–∞—è –≤—ã—Å–æ—Ç–∞ */
      height: 100dvh;
      padding: calc(env(safe-area-inset-top, 0) + 12px) 16px calc(env(safe-area-inset-bottom, 0) + 12px);
      display: grid;
      grid-template-rows: auto 1fr;
      gap: 14px;
    }

    /* –ú–∏–Ω–∏-—à–∞–ø–∫–∞ –≤–Ω—É—Ç—Ä–∏ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤ */
    .topbar {
      display:flex; align-items:center; gap:10px;
    }
    .back {
      border:1px solid var(--border);
      background: rgba(255,255,255,.04);
      backdrop-filter: blur(6px);
      -webkit-backdrop-filter: blur(6px);
      color: var(--fg);
      padding:8px 10px; border-radius:10px; cursor:pointer;
      transition: transform .08s ease, background .2s ease;
    }
    .back:active { transform: translateY(1px) scale(.98); }
    .brand { font-weight:800; font-size:16px; letter-spacing:.2px; }
    .spacer { flex:1 }

    /* –ü–ª–∏—Ç–∫–∏ –≤—ã–±–æ—Ä–∞ –Ω–∞ –≤—Ö–æ–¥–µ */
    .grid-tiles {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 14px;
      height: 100%;
    }
    .tile {
      border:1px solid var(--border);
      border-radius:16px;
      background: linear-gradient(160deg, rgba(125,211,252,.12), rgba(167,139,250,.10));
      box-shadow: var(--shadow);
      display:flex; flex-direction:column; justify-content:center; align-items:center;
      gap:10px;
      transition: transform .15s ease, box-shadow .2s ease, background .3s ease;
      cursor:pointer;
      padding: 18px;
      animation: cardIn .35s ease both;
    }
    .tile:hover { transform: translateY(-2px); }
    .tile:active { transform: translateY(1px) scale(.99); }
    .tile h2 { margin:0; font-size:22px; }
    .tile p { margin:0; color:var(--muted); font-size:13px; text-align:center; }

    .cards {
      display:grid; grid-template-columns: repeat(3, 1fr); gap: 10px;
    }
    .card {
      border:1px solid var(--border); border-radius:14px; background: var(--card);
      padding:12px; box-shadow: var(--shadow);
      display:flex; flex-direction:column; gap:8px;
      animation: cardIn .3s ease both;
    }
    .card h3 { margin:0; font-size:14px; }
    .row { display:flex; gap:8px; align-items:center; }
    .muted { color: var(--muted); font-size: 12px; }
    .btn, .chip, .tab {
      border:1px solid var(--border);
      border-radius:10px; padding:8px 10px; background: rgba(255,255,255,.04);
      transition: transform .08s ease, background .2s ease;
    }
    .btn:active, .chip:active, .tab:active { transform: translateY(1px) scale(.98); }
    .tabs { display:flex; gap:8px; flex-wrap:wrap }
    .tab.active { background: linear-gradient(90deg, var(--acc3), var(--acc2)); color:#08121a; font-weight:700; }

    input, select, textarea {
      width:100%; padding:10px; border-radius:10px; border:1px solid var(--border);
      background: rgba(255,255,255,.03); color: var(--fg);
    }
    .list {
      display:flex; flex-direction:column; gap:8px;
      overflow:auto; /* –µ—Å–ª–∏ –ø–µ—Ä–µ–≥—Ä—É–∑–∏—à—å –∑–∞–¥–∞—á–∞–º–∏ ‚Äî —Å–∫—Ä–æ–ª–ª —Ç–æ–ª—å–∫–æ –≤–Ω—É—Ç—Ä–∏ —Å–ø–∏—Å–∫–∞ */
      padding-right:2px;
    }
    .task {
      display:flex; justify-content:space-between; align-items:center; gap:10px;
      border:1px solid var(--border); border-radius:12px; background: rgba(255,255,255,.03);
      padding:10px; animation: fade .2s ease both;
    }
    .title { font-weight:600; }
    .meta { color:var(--muted); font-size:11px; }
    .pri { padding:2px 6px; border-radius:6px; border:1px solid var(--border); font-size:10px; margin-left:6px; }
    .p2 { background: rgba(244,114,182,.15); border-color: rgba(244,114,182,.35); }
    .p1 { background: rgba(250,204,21,.15); border-color: rgba(250,204,21,.35); }
    .p0 { background: rgba(52,211,153,.15); border-color: rgba(52,211,153,.35); }
    .done { opacity:.6; text-decoration: line-through; }

    /* –ö–∞–ª–µ–Ω–¥–∞—Ä—å */
    .calendar {
      display:grid;
      grid-template-rows: auto auto 1fr;
      gap:10px; height:100%;
    }
    .cal-head { display:flex; align-items:center; gap:8px; }
    .cal-grid {
      display:grid; gap:6px;
      grid-template-columns: repeat(7, 1fr);
      grid-auto-rows: 1fr;
      align-content: stretch;
    }
    .dow { text-align:center; font-size:11px; color:var(--muted); }
    .day {
      border:1px solid var(--border); border-radius:12px; padding:8px;
      display:flex; flex-direction:column; align-items:flex-start; gap:6px;
      background: rgba(255,255,255,.03);
      transition: background .15s ease, transform .08s ease;
      min-height: 64px;
    }
    .day .d { font-weight:700; }
    .day:hover { background: rgba(255,255,255,.05); }
    .day.sel { outline:2px solid var(--acc2); }
    .day.today { outline:2px dashed var(--acc1); }
    .dots { display:flex; gap:3px; }
    .dot { width:6px; height:6px; border-radius:50%; background: var(--acc3); opacity:.8 }

    /* –ê–Ω–∏–º–∞—Ü–∏–∏ */
    @keyframes page { from {opacity:0; transform:translateY(8px)} to {opacity:1; transform:none} }
    @keyframes cardIn { from {opacity:0; transform: translateY(6px) scale(.98)} to {opacity:1; transform:none} }
    @keyframes fade { from {opacity:.0} to {opacity:1} }
    .page { animation: page .25s ease both; }

    /* iPhone 15 Pro —Å–ø–µ—Ü–∏—Ñ–∏—á–Ω—ã–µ —à—Ç—Ä–∏—Ö–∏ */
    .touch-target { min-height: 40px; min-width: 40px; }

    @media (prefers-reduced-motion: reduce) {
      * { animation: none !important; transition: none !important; }
    }
  </style>
</head>
<body>
  <div id="root"></div>
  <script>
  ;(function(){
    const { useState, useEffect, useMemo } = React;

    // ---------- utils ----------
    const todayISO = () => new Date(Date.now()-new Date().getTimezoneOffset()*60000).toISOString().slice(0,10);
    const ymKey = (d) => d.slice(0,7);
    const clamp = (n,a,b)=>Math.max(a,Math.min(b,n));
    const go = (hash)=>{ location.hash = hash.startsWith('#') ? hash : '#'+hash; };
    const backTo = (fallback)=>{ if(history.length>1) history.back(); else go(fallback); };

    const S = {
      get:(k,fall)=>{ try{ return JSON.parse(localStorage.getItem(k)) ?? fall }catch(e){ return fall } },
      set:(k,v)=> localStorage.setItem(k, JSON.stringify(v))
    };

    function useRoute(){
      const [r,setR]=useState(location.hash.slice(1)||"/");
      useEffect(()=>{
        const on=()=>setR(location.hash.slice(1)||"/");
        if(!location.hash) location.hash = "#/";
        window.addEventListener("hashchange",on);
        return ()=>window.removeEventListener("hashchange",on);
      },[]);
      return r;
    }

    // ---------- data ----------
    const PKEY="sv2_projects", TKEY="sv2_tasks", JKEY="sv2_journal";
    const uid = () => Math.random().toString(36).slice(2,10);

    // ---------- Landing ----------
    function Landing(){
      return (
        <div className="screen page">
          <div className="topbar">
            <div className="brand">SolvoLab</div>
            <div className="spacer"></div>
          </div>
          <div className="grid-tiles">
            <div className="tile" onclick={()=>go('/workspace')}>
              <h2>Workspace</h2>
              <p>–ü–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ: Today, Calendar, Projects, Inbox</p>
            </div>
            <div className="tile" onclick={()=>go('/mind')}>
              <h2>Mind Space</h2>
              <p>–ñ—É—Ä–Ω–∞–ª, –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∏–µ –∏ –ø—Ä–æ—Å—Ç–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞</p>
            </div>
          </div>
        </div>
      );
    }

    // ---------- Workspace ----------
    function WorkspaceHome(){
      return (
        <div className="screen page">
          <div className="topbar">
            <button className="back touch-target" onclick={()=>backTo('/')}>‚Üê</button>
            <div className="brand">Workspace</div>
            <div className="spacer"></div>
          </div>
          <div className="cards">
            <a className="card" href="#/workspace/today"><h3>Today</h3><div className="muted">–§–æ–∫—É—Å –Ω–∞ —Ç–µ–∫—É—â–∏–π –¥–µ–Ω—å</div></a>
            <a className="card" href="#/workspace/calendar"><h3>Calendar</h3><div className="muted">–ü–æ–ª–Ω–æ—Ü–µ–Ω–Ω–∞—è —Å–µ—Ç–∫–∞ —Å –∑–∞–¥–∞—á–∞–º–∏</div></a>
            <a className="card" href="#/workspace/projects"><h3>Projects</h3><div className="muted">–°–ø–∏—Å–æ–∫ –ø—Ä–æ–µ–∫—Ç–æ–≤</div></a>
            <a className="card" href="#/workspace/inbox"><h3>Inbox</h3><div className="muted">–ë—ã—Å—Ç—Ä—ã–µ –∑–∞–ø–∏—Å–∏ –±–µ–∑ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞</div></a>
          </div>
        </div>
      );
    }

    function useTasks(){
      const [projects,setProjects]=useState(()=>S.get(PKEY,[{id:"inbox",name:"–í—Ö–æ–¥—è—â–∏–µ"}]));
      const [tasks,setTasks]=useState(()=>S.get(TKEY,[]));
      useEffect(()=>S.set(PKEY,projects),[projects]);
      useEffect(()=>S.set(TKEY,tasks),[tasks]);
      const projMap = useMemo(()=>Object.fromEntries(projects.map(p=>[p.id,p.name])),[projects]);
      return {projects,setProjects,tasks,setTasks,projMap};
    }

    function TodayPage(){
      const {projects,tasks,setTasks,projMap}=useTasks();
      const [date,setDate]=useState(todayISO());
      const [q,setQ]=useState("");
      const [draft,setDraft]=useState({title:"",projectId:"inbox",pri:1,due:todayISO(),notes:""});

      const addTask=()=>{
        const title = draft.title.trim(); if(!title) return;
        const t={id:uid(),title,projectId:draft.projectId||"inbox",pri:+draft.pri,due:draft.due||todayISO(),notes:draft.notes.trim(),done:false,createdAt:Date.now()};
        setTasks(ts=>[t,...ts]); setDraft(d=>({...d,title:"",notes:""}));
      };
      const toggle=(id)=>setTasks(ts=>ts.map(t=>t.id===id?{...t,done:!t.done}:t));
      const del=(id)=>setTasks(ts=>ts.filter(t=>t.id!==id));

      const list = useMemo(()=>tasks
        .filter(t=>t.due===date)
        .filter(t=>!q || (t.title+" "+(t.notes||"")).toLowerCase().includes(q.toLowerCase()))
        .sort((a,b)=>(b.pri-a.pri)||(a.done-b.done)||(a.createdAt-b.createdAt)),[tasks,date,q]);

      return (
        <div className="screen page">
          <div className="topbar">
            <button className="back touch-target" onclick={()=>backTo('/workspace')}>‚Üê</button>
            <div className="brand">Today</div>
            <div className="spacer"></div>
            <input type="date" value={date} onchange={e=>setDate(e.target.value)} style="width:auto"/>
          </div>
          <div className="cards" style="grid-template-columns: 1.2fr 1fr 1fr">
            <div className="card" style="grid-column: span 3">
              <div className="row">
                <input placeholder="–ó–∞–¥–∞—á–∞" value={draft.title} oninput={e=>setDraft({...draft,title:e.target.value})}/>
                <select value={draft.projectId} onchange={e=>setDraft({...draft,projectId:e.target.value})}>
                  {projects.map(p=>React.createElement('option',{value:p.id, key:p.id},p.name))}
                </select>
                <select value={draft.pri} onchange={e=>setDraft({...draft,pri:e.target.value})}>
                  <option value="2">üî• –í—ã—Å–æ–∫–∏–π</option><option value="1">–°—Ä–µ–¥–Ω–∏–π</option><option value="0">–ù–∏–∑–∫–∏–π</option>
                </select>
                <input type="date" value={draft.due} onchange={e=>setDraft({...draft,due:e.target.value})} style="width:auto"/>
                <button className="btn" onclick={addTask}>–î–æ–±–∞–≤–∏—Ç—å</button>
              </div>
              <input className="muted" placeholder="–ü–æ–∏—Å–∫..." value={q} oninput={e=>setQ(e.target.value)} style="margin-top:8px"/>
            </div>
            <div className="card" style="grid-column: span 3; display:flex; flex-direction:column;">
              <div className="list" style="flex:1">
                {list.length===0
                  ? <div className="muted">–ù–∞ –≤—ã–±—Ä–∞–Ω–Ω—É—é –¥–∞—Ç—É –∑–∞–¥–∞—á –Ω–µ—Ç.</div>
                  : list.map(t=>(
                    <div className={"task "+(t.done?"done":"")} key={t.id}>
                      <div style={{flex:1}}>
                        <div className="title">{t.title}<span className={"pri p"+t.pri}>P{t.pri}</span></div>
                        <div className="meta">{t.notes||"‚Äî"} ‚Ä¢ {projMap[t.projectId]||"–í—Ö–æ–¥—è—â–∏–µ"}</div>
                      </div>
                      <div className="row">
                        <button className="chip" onclick={()=>toggle(t.id)}>{t.done?"–í–µ—Ä–Ω—É—Ç—å":"–ì–æ—Ç–æ–≤–æ"}</button>
                        <button className="chip" onclick={()=>del(t.id)}>–£–¥–∞–ª–∏—Ç—å</button>
                      </div>
                    </div>
                  ))
                }
              </div>
            </div>
          </div>
        </div>
      );
    }

    function weeksInMonth(year,month){ // month: 0-11
      const first = new Date(Date.UTC(year, month, 1));
      const last  = new Date(Date.UTC(year, month+1, 0));
      const start = (first.getUTCDay()+6)%7; // Mon=0
      const days = last.getUTCDate();
      const cells = start + days;
      return Math.ceil(cells/7);
    }
    function daysGrid(year,month){
      const first = new Date(Date.UTC(year, month, 1));
      const last  = new Date(Date.UTC(year, month+1, 0));
      const start = (first.getUTCDay()+6)%7;
      const days = last.getUTCDate();
      const grid = [];
      for(let i=0;i<start;i++) grid.push(null);
      for(let d=1; d<=days; d++) grid.push(d);
      while(grid.length % 7) grid.push(null);
      return grid;
    }

    function CalendarPage(){
      const {tasks,setTasks}=useTasks();
      const today=todayISO();
      const [sel,setSel]=useState(today);
      const [cursor,setCursor]=useState(()=>{ const d=new Date(); return {y:d.getFullYear(), m:d.getMonth()} });

      const byDay = useMemo(()=> {
        const map={};
        for(const t of tasks){ (map[t.due] ||= []).push(t); }
        return map;
      },[tasks]);

      const nextMonth=()=> setCursor(c=>({y:c.m===11?c.y+1:c.y, m:(c.m+1)%12}));
      const prevMonth=()=> setCursor(c=>({y:c.m===0?c.y-1:c.y, m:(c.m+11)%12}));
      const setToday=()=>{ const d=new Date(); setCursor({y:d.getFullYear(), m:d.getMonth()}); setSel(today); };

      const grid = daysGrid(cursor.y, cursor.m);
      const monthISO = (d)=>`${cursor.y}-${String(cursor.m+1).padStart(2,'0')}-${String(d).padStart(2,'0')}`;

      return (
        <div className="screen page">
          <div className="topbar">
            <button className="back touch-target" onclick={()=>backTo('/workspace')}>‚Üê</button>
            <div className="brand">Calendar</div>
            <div className="spacer"></div>
            <button className="tab" onclick={prevMonth}>‚Äπ</button>
            <div className="chip">{new Date(Date.UTC(cursor.y,cursor.m,1)).toLocaleString('ru-RU',{month:'long',year:'numeric'})}</div>
            <button className="tab" onclick={nextMonth}>‚Ä∫</button>
            <button className="tab" onclick={setToday}>–°–µ–≥–æ–¥–Ω—è</button>
          </div>

          <div className="calendar">
            <div className="cal-head">
              <div className="row" style="gap:12px">
                <div className="muted">–ù–µ–¥–µ–ª—è –Ω–∞—á–∏–Ω–∞–µ—Ç—Å—è —Å –ü–Ω</div>
              </div>
            </div>
            <div className="cal-grid">
              {["–ü–Ω","–í—Ç","–°—Ä","–ß—Ç","–ü—Ç","–°–±","–í—Å"].map(d=><div className="dow" key={d}>{d}</div>)}
              {grid.map((d,i)=>{
                if(d===null) return <div key={"x"+i}></div>;
                const iso = monthISO(d);
                const isToday = iso===today;
                const isSel = iso===sel;
                const dots = (byDay[iso]?.length||0);
                return (
                  <div className={"day"+(isToday?" today":"")+(isSel?" sel":"")} key={iso} onclick={()=>setSel(iso)}>
                    <div className="d">{String(d)}</div>
                    <div className="dots">
                      {Array.from({length: Math.min(3,dots)}).map((_,j)=><div className="dot" key={j}></div>)}
                    </div>
                  </div>
                );
              })}
            </div>
            <div className="card" style="display:flex; gap:8px; flex-direction:column;">
              <div className="row">
                <div className="chip">–í—ã–±—Ä–∞–Ω–æ: {new Date(sel+"T00:00:00").toLocaleDateString('ru-RU')}</div>
                <div className="muted">–ó–∞–¥–∞—á: {byDay[sel]?.length||0}</div>
              </div>
              <div className="list" style="max-height: 34svh">
                {(byDay[sel]||[]).map(t=>(
                  <div className={"task "+(t.done?"done":"")} key={t.id}>
                    <div style={{flex:1}}>
                      <div className="title">{t.title}<span className={"pri p"+t.pri}>P{t.pri}</span></div>
                      <div className="meta">{t.notes||"‚Äî"}</div>
                    </div>
                    <div className="row">
                      <button className="chip" onclick={()=>{
                        setTasks(ts=>ts.map(x=>x.id===t.id?{...x,done:!x.done}:x))
                      }}>{t.done?"–í–µ—Ä–Ω—É—Ç—å":"–ì–æ—Ç–æ–≤–æ"}</button>
                    </div>
                  </div>
                ))}
                {(!byDay[sel]||byDay[sel].length===0) && <div className="muted">–ù–∞ —ç—Ç—É –¥–∞—Ç—É –ø–æ–∫–∞ –ø—É—Å—Ç–æ.</div>}
              </div>
            </div>
          </div>
        </div>
      );
    }

    function ProjectsPage(){
      const {projects,setProjects,tasks,setTasks}=useTasks();
      const [pname,setPname]=useState("");
      const add=()=>{ const n=pname.trim(); if(!n) return; setProjects(ps=>[...ps,{id:uid(),name:n}]); setPname(""); };
      const per = useMemo(()=>projects.map(p=>({p,items:tasks.filter(t=>t.projectId===p.id)})),[projects,tasks]);
      return (
        <div className="screen page">
          <div className="topbar">
            <button className="back touch-target" onclick={()=>backTo('/workspace')}>‚Üê</button>
            <div className="brand">Projects</div><div className="spacer"></div>
          </div>
          <div className="cards" style="grid-template-columns: 1fr 1fr 1fr">
            <div className="card" style="grid-column: span 3">
              <div className="row">
                <input placeholder="–ù–æ–≤—ã–π –ø—Ä–æ–µ–∫—Ç..." value={pname} oninput={e=>setPname(e.target.value)}/>
                <button className="btn" onclick={add}>–î–æ–±–∞–≤–∏—Ç—å</button>
              </div>
            </div>
            {per.map(({p,items})=>(
              <div className="card" key={p.id}>
                <h3>{p.name}</h3>
                <div className="muted">–ó–∞–¥–∞—á: {items.length}</div>
              </div>
            ))}
          </div>
        </div>
      );
    }

    function InboxPage(){
      const {tasks,setTasks}=useTasks();
      const [text,setText]=useState("");
      const add=()=>{ const t=text.trim(); if(!t) return; setTasks(ts=>[{id:uid(),title:t,projectId:"inbox",pri:1,due:todayISO(),notes:"",done:false,createdAt:Date.now()},...ts]); setText(""); };
      const list = useMemo(()=>tasks.filter(t=>t.projectId==="inbox"),[tasks]);
      const toggle=(id)=>setTasks(ts=>ts.map(t=>t.id===id?{...t,done:!t.done}:t));
      const del=(id)=>setTasks(ts=>ts.filter(t=>t.id!==id));
      return (
        <div className="screen page">
          <div className="topbar">
            <button className="back touch-target" onclick={()=>backTo('/workspace')}>‚Üê</button>
            <div className="brand">Inbox</div><div className="spacer"></div>
          </div>
          <div className="cards" style="grid-template-columns: 1fr">
            <div className="card">
              <div className="row">
                <input placeholder="–ë—ã—Å—Ç—Ä–∞—è –º—ã—Å–ª—å/–¥–µ–ª–æ‚Ä¶" value={text} oninput={e=>setText(e.target.value)}/>
                <button className="btn" onclick={add}>–î–æ–±–∞–≤–∏—Ç—å</button>
              </div>
            </div>
            <div className="card" style="min-height:0">
              <div className="list" style="max-height:60svh">
                {list.length===0 ? <div className="muted">–ü—É—Å—Ç–æ.</div> :
                  list.map(t=>(
                    <div className={"task "+(t.done?"done":"")} key={t.id}>
                      <div className="title" style="flex:1">{t.title}</div>
                      <div className="row">
                        <button className="chip" onclick={()=>toggle(t.id)}>{t.done?"–í–µ—Ä–Ω—É—Ç—å":"–ì–æ—Ç–æ–≤–æ"}</button>
                        <button className="chip" onclick={()=>del(t.id)}>–£–¥–∞–ª–∏—Ç—å</button>
                      </div>
                    </div>
                ))}
              </div>
            </div>
          </div>
        </div>
      );
    }

    // ---------- Mind Space ----------
    function MindHome(){
      return (
        <div className="screen page">
          <div className="topbar">
            <button className="back touch-target" onclick={()=>backTo('/')}>‚Üê</button>
            <div className="brand">Mind Space</div><div className="spacer"></div>
          </div>
          <div className="cards">
            <a className="card" href="#/mind/journal"><h3>Journal</h3><div className="muted">–£—Ç—Ä–æ/–≤–µ—á–µ—Ä, –∑–∞–º–µ—Ç–∫–∏</div></a>
            <a className="card" href="#/mind/mood"><h3>Mood</h3><div className="muted">–¢—Ä–µ–∫–∏–Ω–≥ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∏—è</div></a>
            <a className="card" href="#/mind/stats"><h3>Stats</h3><div className="muted">–ë–∞–∑–æ–≤–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞</div></a>
          </div>
        </div>
      );
    }

    function JournalPage(){
      const [iso,setIso]=useState(todayISO());
      const [j,setJ]=useState(()=>S.get(JKEY,{}));
      useEffect(()=>S.set(JKEY,j),[j]);
      const get=()=> j[iso] || {m:{focus:"",thanks:"",top3:""}, e:{wins:"",learn:"",mood:3}, notes:""};
      const day=get();
      const setField=(k,v)=>{
        const d=get();
        const next=JSON.parse(JSON.stringify(d));
        const path=k.split('.');
        if(path[0]==='m') next.m[path[1]]=v;
        else if(path[0]==='e'){
          next.e[path[1]] = path[1]==='mood' ? +v : v;
        } else if(k==='notes') next.notes=v;
        S.set(JKEY,{...j,[iso]:next}); setJ({...j,[iso]:next});
      };
      return (
        <div className="screen page">
          <div className="topbar">
            <button className="back touch-target" onclick={()=>backTo('/mind')}>‚Üê</button>
            <div className="brand">Journal</div><div className="spacer"></div>
            <input type="date" value={iso} onchange={e=>setIso(e.target.value)} style="width:auto"/>
            <button className="tab" onclick={()=>setIso(todayISO())}>–°–µ–≥–æ–¥–Ω—è</button>
          </div>
          <div className="cards" style="grid-template-columns: 1fr 1fr 1fr">
            <div className="card">
              <h3>–£—Ç—Ä–æ</h3>
              <textarea placeholder="–§–æ–∫—É—Å –¥–Ω—è" value={day.m.focus} oninput={e=>setField('m.focus',e.target.value)}></textarea>
              <textarea placeholder="–ë–ª–∞–≥–æ–¥–∞—Ä–Ω–æ—Å—Ç—å (3 –ø—É–Ω–∫—Ç–∞)" value={day.m.thanks} oninput={e=>setField('m.thanks',e.target.value)}></textarea>
              <textarea placeholder="–¢–æ–ø-3 –¥–µ–ª–∞" value={day.m.top3} oninput={e=>setField('m.top3',e.target.value)}></textarea>
            </div>
            <div className="card">
              <h3>–ó–∞–º–µ—Ç–∫–∏</h3>
              <textarea placeholder="–°–≤–æ–±–æ–¥–Ω—ã–π –ø–æ—Ç–æ–∫‚Ä¶" value={day.notes} oninput={e=>setField('notes',e.target.value)} style="height: 240px"></textarea>
            </div>
            <div className="card">
              <h3>–í–µ—á–µ—Ä</h3>
              <textarea placeholder="–ü–æ–±–µ–¥—ã" value={day.e.wins} oninput={e=>setField('e.wins',e.target.value)}></textarea>
              <textarea placeholder="–ß–µ–º—É –Ω–∞—É—á–∏–ª—Å—è" value={day.e.learn} oninput={e=>setField('e.learn',e.target.value)}></textarea>
              <div className="row">
                <span className="muted">–ù–∞—Å—Ç—Ä–æ–µ–Ω–∏–µ</span>
                <input type="range" min="1" max="5" value={day.e.mood} oninput={e=>setField('e.mood',e.target.value)}/>
                <span>{day.e.mood}</span>
              </div>
            </div>
          </div>
        </div>
      );
    }

    function MoodPage(){
      const [j]=useState(()=>S.get(JKEY,{}));
      // –ø—Ä–æ—Å—Ç–∞—è —Å–≤–æ–¥–∫–∞ –∑–∞ 14 –¥–Ω–µ–π
      const last = useMemo(()=>{
        const out=[]; const now=todayISO(); const base=new Date(now+"T00:00:00");
        for(let i=0;i<14;i++){
          const d=new Date(base); d.setDate(d.getDate()-i);
          const iso=new Date(d.getTime()-d.getTimezoneOffset()*60000).toISOString().slice(0,10);
          out.push({iso, mood:j[iso]?.e?.mood ?? null});
        }
        return out;
      },[j]);
      return (
        <div className="screen page">
          <div className="topbar">
            <button className="back touch-target" onclick={()=>backTo('/mind')}>‚Üê</button>
            <div className="brand">Mood</div><div className="spacer"></div>
          </div>
          <div className="cards" style="grid-template-columns: 1fr">
            <div className="card">
              <h3>–ü–æ—Å–ª–µ–¥–Ω–∏–µ 14 –¥–Ω–µ–π</h3>
              <div className="row" style="flex-wrap:wrap">
                {last.map(d=>
                  <div className="chip" key={d.iso}>
                    {new Date(d.iso+"T00:00:00").toLocaleDateString('ru-RU',{day:'2-digit',month:'2-digit'})} ‚Äî {d.mood ?? '‚Äî'}
                  </div>
                )}
              </div>
            </div>
          </div>
        </div>
      );
    }

    function StatsPage(){
      // –∫–∞—Ä–∫–∞—Å –ø–æ–¥ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏–µ
      return (
        <div className="screen page">
          <div className="topbar">
            <button className="back touch-target" onclick={()=>backTo('/mind')}>‚Üê</button>
            <div className="brand">Stats</div><div className="spacer"></div>
          </div>
          <div className="cards">
            <div className="card">
              <h3>–í —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ</h3>
              <div className="muted">–ó–¥–µ—Å—å –º–æ–∂–Ω–æ –±—É–¥–µ—Ç —Å–º–æ—Ç—Ä–µ—Ç—å –∫–æ—Ä—Ä–µ–ª—è—Ü–∏–∏ ¬´–Ω–∞—Å—Ç—Ä–æ–µ–Ω–∏–µ ‚ÜîÔ∏è –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–∫—Ä—ã—Ç—ã—Ö –∑–∞–¥–∞—á¬ª, streak –ø–æ –∂—É—Ä–Ω–∞–ª—É –∏ —Ç.–¥.</div>
            </div>
          </div>
        </div>
      );
    }

    // ---------- Router ----------
    function App(){
      const r = useRoute();
      if(r==="/") return <Landing/>;
      if(r.startsWith("/workspace")){
        if(r==="/workspace") return <WorkspaceHome/>;
        if(r.startsWith("/workspace/today")) return <TodayPage/>;
        if(r.startsWith("/workspace/calendar")) return <CalendarPage/>;
        if(r.startsWith("/workspace/projects")) return <ProjectsPage/>;
        if(r.startsWith("/workspace/inbox")) return <InboxPage/>;
        return <WorkspaceHome/>;
      }
      if(r.startsWith("/mind")){
        if(r==="/mind") return <MindHome/>;
        if(r.startsWith("/mind/journal")) return <JournalPage/>;
        if(r.startsWith("/mind/mood")) return <MoodPage/>;
        if(r.startsWith("/mind/stats")) return <StatsPage/>;
        return <MindHome/>;
      }
      return <Landing/>;
    }

    ReactDOM.createRoot(document.getElementById('root')).render(<App/>);
  })();
  </script>
</body>
</html>
